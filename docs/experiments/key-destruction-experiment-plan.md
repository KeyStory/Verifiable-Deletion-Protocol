# 密钥销毁有效性实验方案

## 实验目的

验证不同密钥销毁方法的有效性，量化内存残留风险。

## 实验假设

- H0（零假设）：密钥销毁后，内存中仍有残留
- H1（备择假设）：使用安全销毁方法后，内存中无残留

## 实验设计

### 变量

**自变量（销毁方法）**:
1. 方法A：简单del（基准组）
2. 方法B：单次零覆写
3. 方法C：多次覆写（DoD 5220.22-M标准）
4. 方法D：使用libsodium的sodium_memzero

**因变量（可恢复性）**:
- 可恢复字节数
- 完整密钥恢复成功率

**控制变量**:
- 密钥长度：固定32字节
- 内存dump时机：销毁后立即、1秒后、10秒后
- 运行环境：Ubuntu 22.04, Python 3.11

### 实验步骤

1. **准备阶段**
   - 生成测试密钥（32字节随机数据）
   - 记录密钥特征模式（前16字节）

2. **执行阶段**
   - 在内存中创建密钥
   - 模拟正常使用（加密/解密操作）
   - 调用销毁方法
   - 在不同时间点dump内存

3. **分析阶段**
   - 使用Volatility分析内存dump
   - 使用自定义脚本搜索密钥模式
   - 统计可恢复字节数

4. **重复**
   - 每种方法重复30次
   - 计算平均值和标准差

## 实验工具

- **内存dump**: gcore, /proc/<pid>/mem
- **内存分析**: Volatility 3
- **模式搜索**: 自定义Python脚本
- **统计分析**: scipy, matplotlib

## 数据收集表格

| 试次 | 方法 | Dump时机 | 发现次数 | 可恢复字节 | 完整恢复 |
|------|------|---------|---------|-----------|----------|
| 1 | A | 立即 | | | |
| 2 | A | 1秒 | | | |
| ... | | | | | |

## 预期结果

- 方法A（del）：预期有高残留率（>80%）
- 方法B（单次覆写）：预期中等残留率（30-50%）
- 方法C（多次覆写）：预期低残留率（<10%）
- 方法D（libsodium）：预期零残留率（0%）

## 统计分析

使用单因素方差分析(ANOVA)比较不同方法：
- 零假设：各方法的平均残留率无显著差异
- 显著性水平：α = 0.05
- 如果p < 0.05，拒绝零假设

## 实验限制

1. **环境限制**: 实验在虚拟机中进行，与物理机可能有差异
2. **工具限制**: Volatility可能无法检测所有内存残留
3. **时间限制**: 无法测试极长时间后的残留

## 实验脚本

见 `experiments/key_destruction/run_experiment.py`